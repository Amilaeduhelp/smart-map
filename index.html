<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ශ්‍රී ලංකා ඉතිහාසික සිතියම</title>
    <style>
        body {
            font-family: 'Arial Unicode MS', 'Iskoola Pota', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        /* New information bar styling */
        .info-bar {
            background-color: #d4edda; /* Light green color */
            color: #000000; /* Black text */
            padding: 10px 15px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 20;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .info-bar-content {
            flex-grow: 1;
        }

        .info-bar-brand {
            font-weight: bold;
            margin-right: 15px;
        }

        .container {
            display: flex;
            flex-direction: row;
            width: 100%;
            height: calc(100vh - 90px); /* Adjusted to accommodate both top and bottom bars */
            margin-top: 50px; /* Added to accommodate the fixed info bar */
            margin-bottom: 40px; /* Added space for footer */
        }

        .place-list {
            width: 300px;
            background-color: #fff;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
            height: 100%;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            z-index: 10;
        }

        .place-list h2 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #8b4513;
            padding-bottom: 10px;
        }

        .place-list ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
            flex-grow: 1;
            overflow-y: auto;
        }

        .place-list li {
            padding: 10px 15px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .place-list li:hover {
            background-color: #f0f0f0;
        }

        .map-container {
            flex-grow: 1;
            position: relative;
            overflow: auto;
            background-color: #ffffff;
        }

        .map-wrapper {
            position: relative;
            width: fit-content;
            height: fit-content;
            min-width: 100%;
            min-height: 100%;
        }

        .map-image {
            display: block;
        }

        /* කුඩා කරන ලද ලකුණු කිරීමේ ලක්ෂ්‍යය */
        .location-marker {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: red;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 5;
            pointer-events: none;
        }

        /* වඩා දුරට විහිදෙන රවුම */
        .location-ring {
            position: absolute;
            width: 80px;
            height: 80px;
            border: 4px solid red;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 4;
            pointer-events: none;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(1.8);
                opacity: 0;
            }
        }

        .tooltip {
            position: absolute;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            font-size: 25px;
            pointer-events: none;
            z-index: 6;
            display: none;
			transform: translateX(40px);
        }

        .header {
            background-color: #8b4513;
            color: white;
            text-align: center;
            padding: 10px 0;
            width: 100%;
        }
        
        .map-selector {
            position: fixed;
            top: 70px; /* Adjusted to accommodate the info bar */
            right: 20px;
            background-color: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 15;
        }
        
        .map-selector select {
            padding: 5px;
            font-family: 'Arial Unicode MS', 'Iskoola Pota', Arial, sans-serif;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 200px;
        }
        
        .map-selector label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }

        /* Active place highlight */
        .place-list li.active {
            background-color: #e0e0e0;
            font-weight: bold;
        }

        /* අකාරාදී බටන් සඳහා */
        .alphabet-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            padding: 10px 0;
            border-bottom: 1px solid #ddd;
            margin-bottom: 10px;
        }

        .alphabet-button {
            background-color: #114704;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-family: 'Arial Unicode MS', 'Iskoola Pota', Arial, sans-serif;
            font-size: 14px;
            min-width: 30px;
            text-align: center;
        }

        .alphabet-button:hover {
            background-color: #37960b;
        }

        .alphabet-button.active {
            background-color: #2c6809;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
        }

        /* Show all button */
        .show-all-button {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-family: 'Arial Unicode MS', 'Iskoola Pota', Arial, sans-serif;
            font-size: 14px;
            margin-bottom: 10px;
            display: block;
            width: 100%;
        }

        .show-all-button:hover {
            background-color: #218838;
        }

        #backButton {
            background-color: #8b4513;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Arial Unicode MS', 'Iskoola Pota', Arial, sans-serif;
            margin-bottom: 10px;
            display: block;
            width: 100%;
        }

        #backButton:hover {
            background-color: #6b3209;
        }

        /* Footer styling - Fixed footer at bottom of page */
        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40px; /* Fixed height */
            background-color: rgba(255, 255, 255, 0.95); /* Slightly transparent white */
            border-top: 1px solid #ddd;
            padding: 8px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 20; /* Ensure it's above other elements */
            font-size: 14px;
            box-sizing: border-box;
        }

        .footer-brand {
            font-weight: bold;
        }

        .footer-brand a {
            color: #114704;
            text-decoration: none;
        }

        .footer-brand a:hover {
            text-decoration: underline;
        }

        .footer-reset-button {
            background-color: #8b4513;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-family: 'Arial Unicode MS', 'Iskoola Pota', Arial, sans-serif;
        }

        .footer-reset-button:hover {
            background-color: #6b3209;
        }

        /* මීඩියා විමසුම් සඳහා */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                margin-top: 50px; /* Adjusted for mobile */
                height: calc(100vh - 90px); /* Adjusted for footer */
            }
            
            .place-list {
                width: 100%;
                height: 40%;
                min-height: 200px;
            }
            
            .map-container {
                height: 60%;
            }
            
            .map-selector {
                top: 60px; /* Adjusted for mobile */
            }
            
            /* Ensure footer is visible on mobile */
            .footer {
                height: 40px;
            }
        }
    </style>
</head>
<body>
    <!-- New info bar that stays fixed at the top -->
    <div class="info-bar">
        <div class="info-bar-content" id="infoContent">සැකසුම අමිල උඩවත්ත</div>
    </div>

    <div class="container">
        <div class="place-list">
            <h2>ස්ථාන නාමාවලිය</h2>
            
            <!-- අකාරාදී බටන් -->
            <div class="alphabet-buttons" id="alphabetButtons">
                <!-- JavaScript මගින් මෙහි බටන් ඇතුළත් කරනු ලැබේ -->
            </div>
            
            <!-- සියලු ස්ථාන පෙන්වීමේ බටනය -->
            <button id="showAllButton" class="show-all-button">සියලුම ස්ථාන</button>
            
            <ul id="placesList">
                <!-- Place names will be added here dynamically -->
            </ul>
        </div>
        
        <div class="map-container" id="mapContainer">
            <div class="map-selector">
                <label for="mapType">සිතියම් වර්ගය තෝරන්න:</label>
                <select id="mapType">
                    <option value="sl_al">උසස් පෙළ ලංකා සිතියම</option>
                    <option value="india_al">උසස් පෙළ ඉන්දියා සිතියම</option>
                    <option value="europe_al">උසස් පෙළ යුරෝපා සිතියම</option>
                    <option value="sl_ol">සාමාන්‍ය පෙළ ලංකා සිතියම</option>
                    <option value="eurasia_ol">සාමාන්‍ය පෙළ යුරේසියා සිතියම</option>
                </select>
            </div>
            
            <div class="map-wrapper" id="mapWrapper">
                <img src="https://www.eduhelp.lk/wp-content/uploads/2025/05/001_2020_ලංකා-ඉතිහාසය-සිතියම2-01.jpg" alt="සිතියම" class="map-image" id="mapImage">
                <div id="locationMarker" class="location-marker" style="display: none;"></div>
                <div id="locationRing" class="location-ring" style="display: none;"></div>
                <div id="tooltip" class="tooltip"></div>
            </div>
            
 
        </div>
    </div>
    
    <!-- Fixed footer at bottom of page -->
    <div class="footer">
        <div class="footer-brand">
            <a href="https://www.eduhelp.lk" target="_blank">අමිල උඩවත්ත-eduhelp.lk</a>
        </div>
        <button id="footerResetButton" class="footer-reset-button">නැවත සැකසීම</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mapContainer = document.getElementById('mapContainer');
            const mapWrapper = document.getElementById('mapWrapper');
            const mapImage = document.getElementById('mapImage');
            const placesList = document.getElementById('placesList');
            const locationMarker = document.getElementById('locationMarker');
            const locationRing = document.getElementById('locationRing');
            const tooltip = document.getElementById('tooltip');
            const mapTypeSelect = document.getElementById('mapType');

            const footerResetButton = document.getElementById('footerResetButton');
            const alphabetButtons = document.getElementById('alphabetButtons');
            const showAllButton = document.getElementById('showAllButton');
            const infoContent = document.getElementById('infoContent');
            
            // State variables
            let activePlace = null;
            let activeLetterFilter = null;
            let currentMapKey = 'sl_al';
            const currentZoom = 1.0; // Fixed at 100% zoom
            
            // Define maps with their URLs, places, and historical info
            const maps = {
                sl_al: {
                    url: "https://www.eduhelp.lk/wp-content/uploads/2025/05/001_2020_ලංකා-ඉතිහාසය-සිතියම2-01.jpg",
                    places: [
                        {
name: "අනුරාධපුරය",
                            xPercent: 40.2,
                            yPercent: 40.8,
                            info: "ශ්‍රී ලංකාවේ මුල් ම අගනුවර වෙයි. පණ්ඩුකාභය රජු මෙහි පාලකයා ය. පස්වන මිහිඳු රජු චෝළයින්ගේ ග්‍රහණයට නතු වන තුරු වර්ෂ 1450ක් පමණ ලංකාවේ අගනුවර ලෙස පැවතුණි."
},
{
name: "පොළොන්නරුව",
                            xPercent: 58.3,
                            yPercent: 50.4,
                            info: "ශ්‍රී ලංකාවේ දෙවැනි අගනුවරයි. අනුරාධපුර යුගයේ අග එල්ල වූ චෝළ ආක්‍රමණ වලින් පසු ලංකාවේ උතුරු කොටසේ බලය අල්ලාගත් චෝලයෝ මෙය සිය මධ්‍යස්ථානය කරගත්හ.මෙය මධ්‍යස්ථානය කරගත් ලංකාවේ පළමු පාලකයා මහා විජයබාහු රජුය. පරාක්‍රම පාණ්ඩ්‍ය රජ දවස කාලිංගමාඝ මෙහි බලය අල්ලාගන්නා තුරු එය වසර 250ක් පමණ ලංකාවේ අගනුවර වශයෙන් පැවතුණි."
},

                       {
name: "මහනුවර",
                            xPercent: 45.7,
                            yPercent: 63.5,
                            info: "සෙංකඩගලපුර හෙවත් ලංකාවේ අවසන් රාජධානියයි. කෝට්ටේ හයවන බුවනෙකබාහු හෙවත් සපුමල්කුමාරයා බලයේ සිටි කාලයේ සේනාසම්මත වික්‍රමබාහු රජු සෙංකඩගල රාජධානිප පිහිටුවී ය. 1815 දී ශ්‍රී වික්‍රමරාජසිංහ රජු ඉංග්‍රීසීන්ගේ ග්‍රහණයට නතුවන තුරු එය වර්ෂ 400ක් පමණ කාලයක් ලංකාවේ අගනුර වශයෙන් පැවතියේ ය. "
},

                        {
name: "යාපනය",
                            xPercent: 31.8,
                            yPercent: 12.8,
                            info: "ලංකාවේ තවත් ප්‍රාදේශීය රාජධානියක ප්‍රමුඛ නගරය යි.මෙහි ආරම්භය පිළිබඳ නිශ්චිත කාලවකවානු සඳහන් නැතත්, 1619දී පිලිප් ද ඔලිවේරා නම් පෘතුගීසි කපිතාත් මේජර්වරයා විසින් යටත් කරගන්නා තුරු එය ප්‍රාදේශීය රාජධානියක් වශයෙන් පැවතියේ ය.මෙහි වැඩි ම කාලයක් බලයේ සිටියේ ආර්යචක්‍රවර්තී පරපුරයි" 
},

                        { 
                            name: "ගාල්ල", 
                            xPercent: 43.0, 
                            yPercent: 80.0,
                            info: "දකුණු වෙරළබඩ තිබෙන පුරාණ වරාය නගරයකි. පෘතුගීසීන්, ලන්දේසීන් සහ බ්‍රිතාන්‍යයන් යටතේ වැදගත් වෙළඳ කේන්ද්‍රස්ථානයක් විය."
                        },
                        { 
                            name: "තිස්සමහාරාමය", 
                            xPercent: 67.0, 
                            yPercent: 75.0,
                            info: "රුහුණේ රාජධානිය හා සම්බන්ධ ප්‍රදේශයකි. රජ මහා විහාරය මෙන්ම තිස්ස වැව ද මෙහි පිහිටයි."
                        },
                        { 
                            name: "සීගිරිය", 
                            xPercent: 54.0, 
                            yPercent: 34.5,
                            info: "කාශ්‍යප රජතුමා විසින් නිර්මාණය කරන ලද මෙම ගල් පර්වතය තුළ මහා රාජ මන්දිරයක් නිර්මාණය කළේය. ලෝක උරුමයක් ලෙස නම් කර ඇත."
                        },
						{
							name: "දඹකොළපටුන", 
                            xPercent: 30.2, 
                            yPercent: 9.7,
                            info: "ජම්බුකෝළපට්ටනය හෙවත් වත්මන් සම්බිලිතුරෙයි. මෙය ලංකාවේ පැරණි තොටුපළකි. නමුත් වාණිජ වරායක් නොවී ය. ශ්‍රී මහාබෝධිය වැඩමවීම මේ ඔස්සේ සිදු වූයෙන් ඉතිහාස ගතවිය. ඉතිහාසයේ මේ ස්ථානය ගැන සඳහන් වස්සේ අවස්ථා කිහිපයක දී පමණි."
						},

                    ]
                },
                india_al: {
                    url: "https://www.eduhelp.lk/wp-content/uploads/2025/05/ඉන්දියා-ඉතිහාසය-අභ්‍යාස-සිතියම්-02-scaled.jpg",
                    places: [
                        { 
                            name: "දිල්ලි", 
                            xPercent: 45.0, 
                            yPercent: 28.0,
                            info: "දිල්ලි සුල්තාන් සමයේ හා මුගල් අධිරාජ්‍යයේ අගනුවර ලෙස පැවැත්විණි. ඉන්දියාවේ වත්මන් අගනුවර ද වෙයි."
                        },
                        { 
                            name: "මුම්බායි", 
                            xPercent: 32.0, 
                            yPercent: 55.0,
                            info: "මුම්බායි නගරය ඉන්දියාවේ ප්‍රධාන වාණිජ හා මූල්‍ය මධ්‍යස්ථානය වෙයි. එය මුලින් පෘතුගීසීන් විසින් පාලනය කරන ලදි."
                        },
                        { 
                            name: "කොල්කතා", 
                            xPercent: 62.0, 
                            yPercent: 45.0,
                            info: "ශ්‍රී ලංකාවේ මුල් ම අගනුවර වෙයි. පන්සිවිකාය රජු මෙහි පාලකයා ය. වර්ෂ 1450ක් පමණ ලංකාවේ අගනුවර ලෙස පැවතුණි."
                        },
                        { 
                            name: "වාරාණසි", 
                            xPercent: 55.0, 
                            yPercent: 40.0,
                            info: "ගංගා නදිය අසල පිහිටි මෙම ඓතිහාසික නගරය හින්දු ආගමික කටයුතු සඳහා වැදගත් මධ්‍යස්ථානයක් ලෙස පවතී."
                        },
                        { 
                            name: "පාටලිපුත්‍ර", 
                            xPercent: 60.0, 
                            yPercent: 43.0,
                            info: "මෞර්ය අධිරාජ්‍යයේ අගනුවර වූ මෙම නගරය අශෝක අධිරාජයාගේ පාලන කාලයේදී විශේෂ වැදගත්කමක් දැරීය."
                        }
                    ]
                },
                europe_al: {
                    url: "https://www.eduhelp.lk/wp-content/uploads/2025/05/යුරෝපා-ඉතිහාසය2.png",
                    places: [
                        { 
                            name: "ලන්ඩන්", 
                            xPercent: 38.0, 
                            yPercent: 40.0,
                            info: "බ්‍රිතාන්‍ය අධිරාජ්‍යයේ අගනුවර ලෙස ලන්ඩනය ලෝක ඉතිහාසයේ වැදගත් වෙයි. එය තේම්ස් ගංඟාව අසල පිහිටා ඇත."
                        },
                        { 
                            name: "පැරිස්", 
                            xPercent: 42.0, 
                            yPercent: 45.0,
                            info: "ප්‍රංශ අධිරාජ්‍යයේ අගනුවර ලෙස සහ යුරෝපීය නැවෝදයේ වැදගත් මධ්‍යස්ථානයක් වූ පැරිස් නගරය ලෝක ඉතිහාසයට බෙහෙවින් බලපෑවේය."
                        },
                        { 
                            name: "රෝමය", 
                            xPercent: 48.0, 
                            yPercent: 58.0,
                            info: "රෝම අධිරාජ්‍යයේ අගනුවර වූ රෝමය ලෝක ඉතිහාසයේ වැදගත්ම නගරයක් ලෙස සැලකේ. පාප්වරුන්ගේ බලකොටුව ද මෙහි පිහිටා ඇත."
                        },
                        { 
                            name: "බර්ලින්", 
                            xPercent: 52.0, 
                            yPercent: 38.0,
                            info: "ජර්මනියේ අගනුවර වන බර්ලින් නගරය දෙවන ලෝක යුද්ධය අවසානයේ සීතල යුද්ධයේ කේන්ද්‍රස්ථානයක් විය."
                        }
                    ]
                },
 eurasia_ol: {
    url: "https://www.eduhelp.lk/wp-content/uploads/2025/05/web-සා-පෙළ-යුරෝපා-1-01.jpg",
    places: [
        { 
            name: "රෝමය", 
            xPercent: 48.0, 
            yPercent: 58.0,
            info: "රෝම අධිරාජ්‍යයේ අගනුවර වූ රෝමය ලෝක ඉතිහාසයේ වැදගත්ම නගරයක් ලෙස සැලකේ. පාප්වරුන්ගේ බලකොටුව ද මෙහි පිහිටා ඇත."
        },
        { 
            name: "මොස්කව්", 
            xPercent: 68.0, 
            yPercent: 30.0,
            info: "රුසියාවේ අගනුවර වන මොස්කව් නගරය, සෝවියට් සංගමයේ කේන්ද්‍රස්ථානය ලෙස තිබුණි."
        },
        { 
            name: "බීජිං", 
            xPercent: 85.0, 
            yPercent: 45.0,
            info: "චීනයේ අගනුවර වන බීජිං නගරය, පැරණි චීන අධිරාජ්‍යයේ කේන්ද්‍රස්ථානයකි."
        },
        { 
            name: "ටෝකියෝ", 
            xPercent: 92.0, 
            yPercent: 50.0,
            info: "ජපානයේ අගනුවර වන ටෝකියෝ නගරය, මෙයිජි යුගයේ සිට ජපානයේ ආර්ථික හා දේශපාලන කේන්ද්‍රස්ථානය වේ."
        }
    ]
},
sl_ol: {
    url: "https://www.eduhelp.lk/wp-content/uploads/2025/05/සා-පෙළ_ලංකා-සිතියම-01.jpg",
    places: [
        { 
            name: "අනුරාධපුරය", 
            xPercent: 40.2, 
            yPercent: 40.8,
            info: "ශ්‍රී ලංකාවේ මුල් ම අගනුවර වෙයි. පණ්ඩුකාභය රජු මෙහි පාලකයා ය. වර්ෂ 1450ක් පමණ ලංකාවේ අගනුවර ලෙස පැවතුණි."
        },
        { 
            name: "පොළොන්නරුව", 
            xPercent: 58.3, 
            yPercent: 50.4,
            info: "ශ්‍රී ලංකාවේ දෙවැනි අගනුවරයි. මහා විජයබාහු රජු මෙහි පාලකයා ය. වසර 250ක් පමණ ලංකාවේ අගනුවර වශයෙන් පැවතුණි."
        },
        { 
            name: "මහනුවර", 
            xPercent: 45.7, 
            yPercent: 63.5,
            info: "ශ්‍රී ලංකාවේ අවසන් රාජධානියයි. සෙංකඩගල රාජධානිය ලෙස ද හැඳින්වේ. වර්ෂ 400ක් පමණ අගනුවර වශයෙන් පැවතියේ ය."
        },
        { 
            name: "යාපනය", 
            xPercent: 31.8, 
            yPercent: 12.8,
            info: "ලංකාවේ තවත් ප්‍රාදේශීය රාජධානියක ප්‍රමුඛ නගරය යි. ආර්යචක්‍රවර්තී පරපුර මෙහි පාලනය කළෝය."
        }
    ]
}
};

// Initialize map
mapImage.src = maps[currentMapKey].url;
populatePlacesList(maps[currentMapKey].places);
createAlphabetButtons();

// Set map image size
mapImage.onload = function() {
    // Set map dimensions at 100% (fixed)
    mapWrapper.style.width = this.naturalWidth + 'px';
    mapWrapper.style.height = this.naturalHeight + 'px';
    
    // Center the map in view
    centerMapInView();
};

// Display places on the map
function displayPlaces(places) {
    // Clear existing list items
    placesList.innerHTML = '';
    
    // Sort places by name
    places.sort((a, b) => a.name.localeCompare(b, 'si'));
    
    // Add each place to the list
    places.forEach(place => {
        const listItem = document.createElement('li');
        listItem.textContent = place.name;
        listItem.addEventListener('click', function() {
            // Remove active class from all items
            const allItems = placesList.querySelectorAll('li');
            allItems.forEach(item => item.classList.remove('active'));
            
            // Add active class to clicked item
            this.classList.add('active');
            
            // Show marker and ring at place location
            const xPos = (place.xPercent / 100) * mapImage.width;
            const yPos = (place.yPercent / 100) * mapImage.height;
            
            showMarker(xPos, yPos, place.name, place.info);
            
            // Center the map on the marker
            centerMapOnPoint(xPos, yPos);
            
            // Update active place
            activePlace = place;
            
            // Hide all list items except the clicked one
            const placeListContainer = document.querySelector('.place-list');
            // Hide alphabet buttons
            document.getElementById('alphabetButtons').style.display = 'none';
            // Hide "Show All" button
            document.getElementById('showAllButton').style.display = 'none';
            // Add a "back" button to show all places again
            if (!document.getElementById('backButton')) {
                const backButton = document.createElement('button');
                backButton.id = 'backButton';
                backButton.className = 'show-all-button';
                backButton.textContent = 'ලැයිස්තුවට ආපසු';
                backButton.addEventListener('click', function() {
                    // Show alphabet buttons and show all button again
                    document.getElementById('alphabetButtons').style.display = 'flex';
                    document.getElementById('showAllButton').style.display = 'block';
                    // Show all list items
                    allItems.forEach(item => item.style.display = 'block');
                    // Remove back button
                    this.remove();
                });
                placeListContainer.insertBefore(backButton, placesList);
            }
            
            // Hide all list items except the clicked one
            allItems.forEach(item => {
                if (item !== this) {
                    item.style.display = 'none';
                }
            });
        });
        placesList.appendChild(listItem);
    });
}

// Show marker and ring at specified position
function showMarker(x, y, name, info) {
    // Show the marker and ring
    locationMarker.style.left = x + 'px';
    locationMarker.style.top = y + 'px';
    locationMarker.style.display = 'block';
    
    locationRing.style.left = x + 'px';
    locationRing.style.top = y + 'px';
    locationRing.style.display = 'block';
    
    // Update info content in the top bar
    infoContent.textContent = info;
    
    // Show tooltip on hover
    tooltip.textContent = name;
    tooltip.style.left = (x + 15) + 'px';
    tooltip.style.top = (y + 15) + 'px';
    tooltip.style.display = 'block';
}

// Center map in view
function centerMapInView() {
    const mapContainerWidth = mapContainer.clientWidth;
    const mapContainerHeight = mapContainer.clientHeight;
    const mapWidth = mapWrapper.clientWidth;
    const mapHeight = mapWrapper.clientHeight;
    
    // Calculate scroll positions to center the map
    const scrollLeft = (mapWidth - mapContainerWidth) / 2;
    const scrollTop = (mapHeight - mapContainerHeight) / 2;
    
    // Set scroll positions
    mapContainer.scrollLeft = scrollLeft;
    mapContainer.scrollTop = scrollTop;
}

// Center map on a specific point
function centerMapOnPoint(x, y) {
    const mapContainerWidth = mapContainer.clientWidth;
    const mapContainerHeight = mapContainer.clientHeight;
    
    // Calculate scroll positions to center the point
    const scrollLeft = x - (mapContainerWidth / 2);
    const scrollTop = y - (mapContainerHeight / 2);
    
    // Set scroll positions with animation
    mapContainer.scrollTo({
        left: scrollLeft,
        top: scrollTop,
        behavior: 'smooth'
    });
}

// Populate places list
function populatePlacesList(places) {
    displayPlaces(places);
}

// Reset view and clear markers
function resetView() {
    // Hide marker and ring
    locationMarker.style.display = 'none';
    locationRing.style.display = 'none';
    tooltip.style.display = 'none';
    
    // Reset info content
    infoContent.textContent = 'ස්ථානයක් තෝරන්න';
    
    // Center map in view
    centerMapInView();
    
    // Clear active place
    activePlace = null;
    
    // Remove active class from all list items
    const allItems = placesList.querySelectorAll('li');
    allItems.forEach(item => item.classList.remove('active'));
    
    // Reset letter filter
    activeLetterFilter = null;
    updateAlphabetButtonsState();
    
    // Show all places
    displayPlaces(maps[currentMapKey].places);
    
    // Show alphabet buttons and "Show All" button
    document.getElementById('alphabetButtons').style.display = 'flex';
    document.getElementById('showAllButton').style.display = 'block';
    
    // Remove back button if exists
    const backButton = document.getElementById('backButton');
    if (backButton) {
        backButton.remove();
    }
}

// Create alphabet filter buttons
function createAlphabetButtons() {
    // Clear existing buttons
    alphabetButtons.innerHTML = '';
    
    // Create array of Sinhala alphabet
    const sinhalaAlphabet = [
        'අ', 'ආ', 'ඇ', 'ඈ', 'ඉ', 'ඊ', 'උ', 'ඌ', 'එ', 'ඒ', 'ඔ', 'ඕ',
        'ක', 'ඛ', 'ග', 'ඝ', 'ඞ', 'ච', 'ඡ', 'ජ', 'ඣ', 'ඤ', 'ට',
        'ඩ', 'ණ', 'ත', 'ථ', 'ද', 'ධ', 'න', 'ප', 'ඵ', 'බ', 'භ', 'ම',
        'ය', 'ර', 'ල', 'ව', 'ශ', 'ෂ', 'ස', 'හ', 'ළ'
    ];
    
    // Get all place names from the current map
    const places = maps[currentMapKey].places;
    const firstLetters = places.map(place => place.name.charAt(0));
    
    // Create a button for each letter in the Sinhala alphabet
    sinhalaAlphabet.forEach(letter => {
        // Only create a button if there's at least one place starting with this letter
        if (firstLetters.some(firstLetter => firstLetter === letter)) {
            const button = document.createElement('button');
            button.className = 'alphabet-button';
            button.textContent = letter;
            button.addEventListener('click', function() {
                if (activeLetterFilter === letter) {
                    // If clicking the active filter, clear it
                    activeLetterFilter = null;
                    displayPlaces(maps[currentMapKey].places);
                } else {
                    // Set new filter
                    activeLetterFilter = letter;
                    // Filter places by letter
                    const filteredPlaces = maps[currentMapKey].places.filter(
                        place => place.name.charAt(0) === letter
                    );
                    displayPlaces(filteredPlaces);
                }
                updateAlphabetButtonsState();
            });
            alphabetButtons.appendChild(button);
        }
    });
}

// Update the active state of alphabet buttons
function updateAlphabetButtonsState() {
    const buttons = alphabetButtons.querySelectorAll('.alphabet-button');
    buttons.forEach(button => {
        if (button.textContent === activeLetterFilter) {
            button.classList.add('active');
        } else {
            button.classList.remove('active');
        }
    });
}

// Event listeners
mapTypeSelect.addEventListener('change', function() {
    currentMapKey = this.value;
    mapImage.src = maps[currentMapKey].url;
    resetView();
    createAlphabetButtons();
});


footerResetButton.addEventListener('click', resetView);

showAllButton.addEventListener('click', function() {
    // Clear letter filter
    activeLetterFilter = null;
    updateAlphabetButtonsState();
    
    // Show all places
    displayPlaces(maps[currentMapKey].places);
});

// Hide tooltip when mouse leaves map container
mapContainer.addEventListener('mouseleave', function() {
    if (!activePlace) {
        tooltip.style.display = 'none';
    }
});

// Initial setup
resetView();
});
</script>
</body>
</html>
